<?xml version="1.0" ?>
<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
<?xml-stylesheet href="chrome://zotero-platform/content/zotero.css"?>
<?xml-stylesheet href="odfScan.css" type="text/css"?>

<window xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
	xmlns:html="http://www.w3.org/1999/xhtml"
	width="700" height="720"
	minwidth="600" minheight="550"
	onload="Zotero_ODFScanDialog.init()"
	title="ODF/DOCX Scan">

<linkset>
	<html:link rel="localization" href="odf-scan.ftl"/>
</linkset>

<!-- Include Zotero's core scripts to make Zotero object available -->
<script>
	Services.scriptloader.loadSubScript("chrome://zotero/content/include.js", this);
	Services.scriptloader.loadSubScript("chrome://zotero/content/customElements.js", this);
</script>
<script src="odfScan.js"/>

<vbox flex="1" style="padding: 16px;">
	<groupbox>
		<caption label="Conversion Direction"/>
		<radiogroup id="conversion-direction">
			<hbox style="gap: 16px;">
				<radio id="direction-tocitations" label="Markers → Zotero citations" value="tocitations" selected="true" style="flex: 1;"/>
				<radio id="direction-tomarkers" label="Zotero citations → markers" value="tomarkers" style="flex: 1;"/>
			</hbox>
			<hbox style="gap: 16px;">
				<radio id="direction-pandoc" label="Pandoc → Zotero citations" value="pandoctocitations" style="flex: 1;"/>
				<radio id="direction-topandoc" label="Zotero citations → pandoc" value="topandoc" style="flex: 1;"/>
			</hbox>
		</radiogroup>
	</groupbox>

	<vbox class="file-type-description" style="margin-bottom: 16px;">
		<description>Converts between citation markers and active Zotero citations. Supports both Scannable Cite and pandoc syntax. See the <label class="zotero-text-link" href="https://zotero-odf-scan.github.io/zotero-odf-scan/" value="project website" style="margin-left: 0; margin-right: 0;"/> for details.</description>
		<label style="font-weight:bold;margin:0.5em 0 0.25em 0;" value="Scannable Cite format:"/>
		<label style="color:black;margin:0 0 0.25em 2em;" value="{See | Smith, (2012) |p. 45 | for an example |zu:2433:WQVBH98K}"/>
		<label style="margin:0 0 0.5em 4em;font-style:italic;" value="↳ Fields: prefix | readable cite | locator | suffix | item URI"/>
		<label style="font-weight:bold;margin:0.25em 0 0.25em 0;" value="Pandoc citation syntax (uses Zotero Citation Key field):"/>
		<label style="color:black;margin:0 0 0.25em 2em;" value="[see @smith2003, p. 33; -@jones2005, ch. 2]"/>
		<label style="margin:0 0 0.5em 4em;font-style:italic;" value="↳ Prefix, citekey, locator; suppress-author with - prefix; semicolons for multi-cite"/>
		<description style="padding-top:0.5em">Select an input file (ODF or DOCX) and an output file below:</description>
	</vbox>

	<vbox style="margin-bottom: 16px;">
		<label value="Input File" style="font-weight: 600; margin-bottom: 4px;"/>
		<hbox align="center">
			<html:input native="true" type="text" id="input-path" readonly="true" value="No file selected" style="flex: 1; margin-right: 8px;"/>
			<button id="choose-input-file" label="Choose File…"/>
		</hbox>
	</vbox>

	<vbox style="margin-bottom: 16px;">
		<label value="Output File" style="font-weight: 600; margin-bottom: 4px;"/>
		<hbox align="center">
			<html:input native="true" type="text" id="output-path" readonly="true" value="No file selected" style="flex: 1; margin-right: 8px;"/>
			<button id="choose-output-file" label="Choose File…"/>
		</hbox>
	</vbox>

	<vbox id="status-box" style="margin-top: 16px; padding: 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f9f9f9; max-height: 150px; overflow: auto;" hidden="true">
		<label id="status-message" style="font-weight: bold;"/>
		<description id="status-details" style="margin-top: 4px; white-space: pre-wrap; word-wrap: break-word;"/>
	</vbox>

	<spacer flex="1"/>

	<hbox style="margin-top: 16px; justify-content: flex-end;">
		<button id="process-button" label="Process Document" disabled="true"/>
		<button id="close-button" label="Close" oncommand="window.close();"/>
	</hbox>
</vbox>

</window>
